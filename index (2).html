<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>æ£®æ—ç’°ä¿æ¥åƒåœ¾éŠæˆ²</title>
<style>
  html, body {
    margin:0; padding:0; height:100%;
    overflow: hidden;
    font-family: Arial, sans-serif;
    user-select: none;
    background: url("https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1920&q=80") no-repeat center center fixed;
    background-size: cover;
    background-color: #004d00;
  }
  #gameArea {
    position: relative;
    width: 100vw; height: 100vh;
    overflow: hidden;
  }
  #scoreboard {
    position: fixed;
    top: 15px; right: 20px;
    background: rgba(0,0,0,0.6);
    color: #c6f0c6;
    font-size: 22px;
    padding: 10px 18px;
    border-radius: 12px;
    z-index: 100;
    width: 160px;
    text-align: center;
    user-select:none;
  }
  #bucket {
    position: absolute;
    bottom: 20px;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 80px;
    background: rgba(50,150,50,0.9);
    border-radius: 0 0 20px 20px;
    border: 3px solid #c6f0c6;
    box-sizing: border-box;
    font-size: 48px;
    text-align: center;
    line-height: 80px;
    user-select: none;
  }
  .garbage {
    position: absolute;
    font-size: 48px;
    user-select: none;
    pointer-events: none;
    filter: drop-shadow(0 0 3px black);
  }
  #message {
    position: fixed;
    top: 50%; left: 50%;
    transform: translate(-50%, -50%);
    background: rgba(0, 50, 0, 0.85);
    color: #c6f0c6;
    padding: 40px 60px;
    border-radius: 20px;
    text-align: center;
    font-size: 24px;
    z-index: 200;
    user-select: none;
    max-width: 90vw;
  }
  #message button {
    margin-top: 25px;
    padding: 12px 40px;
    font-size: 20px;
    border: none;
    border-radius: 12px;
    background: #32a852;
    color: white;
    cursor: pointer;
  }
  #message button:hover {
    background: #2b8642;
  }
</style>
</head>
<body>

<div id="gameArea">
  <div id="bucket" aria-label="å›æ”¶æ¡¶">ğŸ—‘ï¸</div>
</div>

<div id="scoreboard" style="display:none;" role="region" aria-live="polite" aria-atomic="true">
  åˆ†æ•¸: 0<br />
  å‰©é¤˜æ™‚é–“: 20ç§’
</div>

<div id="message" role="dialog" aria-modal="true">
  <h1>æ£®æ—ç’°ä¿æ¥åƒåœ¾éŠæˆ²</h1>
  <p><strong>éŠæˆ²èªªæ˜ï¼š</strong></p>
  <ul style="text-align:left; max-width: 400px; margin: 0 auto;">
    <li>ç”¨å·¦å³æ–¹å‘éµæ§åˆ¶åº•éƒ¨çš„å›æ”¶æ¡¶å·¦å³ç§»å‹•ã€‚</li>
    <li>å¾ä¸Šæ–¹æ‰è½çš„åƒåœ¾æœ‰å°åƒåœ¾å’Œå¤§å‹åƒåœ¾å…©ç¨®ã€‚</li>
    <li>æ¥ä½å°åƒåœ¾å¯ç²å¾—5åˆ†ï¼Œæ¥ä½å¤§å‹åƒåœ¾å¯ç²å¾—10åˆ†ã€‚</li>
    <li>åƒåœ¾æ‰è½é€Ÿåº¦æœƒéš¨æ™‚é–“é€æ¼¸åŠ å¿«ã€‚</li>
    <li>éŠæˆ²é™æ™‚20ç§’ï¼Œç›®æ¨™åˆ†æ•¸ç‚º60åˆ†ä»¥ä¸Šæ‰ç®—éé—œã€‚</li>
    <li>æœªæ¥ä½åƒåœ¾ä¸æœƒæ‰£åˆ†ï¼Œä½†è¦åŠªåŠ›æ¥ä½æ›´å¤šåƒåœ¾ï¼</li>
  </ul>
  <p>æº–å‚™å¥½ä¿è­·æ£®æ—ç’°å¢ƒäº†å—ï¼Ÿå¿«é–‹å§‹éŠæˆ²å§ï¼</p>
  <button id="startBtn" aria-label="é–‹å§‹éŠæˆ²">é–‹å§‹éŠæˆ²</button>
</div>

<script>
(() => {
  const gameArea = document.getElementById('gameArea');
  const bucket = document.getElementById('bucket');
  const scoreboard = document.getElementById('scoreboard');
  const message = document.getElementById('message');
  const startBtn = document.getElementById('startBtn');

  const gameWidth = window.innerWidth;
  const gameHeight = window.innerHeight;

  let score = 0;
  let timeLeft = 20;
  let gameRunning = false;
  let garbageFallSpeed = 2;
  let garbageSpawnInterval = 1200;
  let bucketSpeed = 15;

  let garbageElements = [];
  let bucketX = gameWidth / 2 - bucket.offsetWidth / 2;

  // åƒåœ¾ç¨®é¡ï¼šå°åƒåœ¾5åˆ†ï¼Œå¤§åƒåœ¾10åˆ†
  const garbageTypes = [
    { emoji: 'ğŸ¥¤', points: 5 },  // å°åƒåœ¾
    { emoji: 'ğŸ¬', points: 5 },  // å°åƒåœ¾
    { emoji: 'ğŸ—‘ï¸', points: 10 }, // å¤§åƒåœ¾
    { emoji: 'ğŸŒ', points: 5 },  // å°åƒåœ¾
    { emoji: 'ğŸ›‹ï¸', points: 10 }, // å¤§åƒåœ¾
  ];

  function updateScoreboard() {
    scoreboard.innerHTML = `åˆ†æ•¸: ${score}<br />å‰©é¤˜æ™‚é–“: ${timeLeft}ç§’`;
  }

  function createGarbage() {
    const type = garbageTypes[Math.floor(Math.random() * garbageTypes.length)];
    const elem = document.createElement('div');
    elem.classList.add('garbage');
    elem.textContent = type.emoji;
    elem.style.left = Math.random() * (gameWidth - 50) + 'px';
    elem.style.top = '-60px';
    elem.dataset.points = type.points;
    gameArea.appendChild(elem);
    garbageElements.push(elem);
  }

  function updateGarbage() {
    garbageElements.forEach((elem, idx) => {
      let top = parseFloat(elem.style.top);
      top += garbageFallSpeed;
      elem.style.top = top + 'px';

      // ç¢°æ’æª¢æŸ¥
      const bucketRect = bucket.getBoundingClientRect();
      const garbageRect = elem.getBoundingClientRect();

      if (
        garbageRect.bottom >= bucketRect.top &&
        garbageRect.left < bucketRect.right &&
        garbageRect.right > bucketRect.left &&
        garbageRect.bottom < bucketRect.bottom + 10
      ) {
        score += parseInt(elem.dataset.points);
        updateScoreboard();
        elem.remove();
        garbageElements.splice(idx, 1);
      } else if (top > gameHeight) {
        elem.remove();
        garbageElements.splice(idx, 1);
      }
    });
  }

  function moveBucket(direction) {
    if (!gameRunning) return;
    if (direction === 'left') {
      bucketX = Math.max(0, bucketX - bucketSpeed);
    } else if (direction === 'right') {
      bucketX = Math.min(gameWidth - bucket.offsetWidth, bucketX + bucketSpeed);
    }
    bucket.style.left = bucketX + 'px';
  }

  let lastSpawnTime = 0;
  let lastFrameTime = 0;

  function gameLoop(timestamp = 0) {
    if (!gameRunning) return;

    if (!lastFrameTime) lastFrameTime = timestamp;
    const delta = timestamp - lastFrameTime;

    if (timestamp - lastSpawnTime > garbageSpawnInterval) {
      createGarbage();
      lastSpawnTime = timestamp;
    }

    updateGarbage();

    lastFrameTime = timestamp;
    requestAnimationFrame(gameLoop);
  }

  let timerId = null;
  function startTimer() {
    timerId = setInterval(() => {
      if (!gameRunning) return;
      timeLeft--;
      updateScoreboard();

      if (timeLeft <= 0) {
        endGame();
      }

      if (timeLeft === 10) {
        garbageFallSpeed += 2;
        if (garbageSpawnInterval > 400) {
          garbageSpawnInterval -= 500;
        }
      }
    }, 1000);
  }

  function endGame() {
    gameRunning = false;
    clearInterval(timerId);
    garbageElements.forEach((e) => e.remove());
    garbageElements = [];
    scoreboard.style.display = 'none';

    message.style.display = 'block';

    if (score >= 60) {
      message.innerHTML = `
        <h1>ğŸ‰ æ­å–œéé—œï¼</h1>
        <p>ä½ çš„åˆ†æ•¸æ˜¯ï¼š${score}åˆ†</p>
        <button id="startBtn" aria-label="é‡æ–°é–‹å§‹éŠæˆ²">é‡æ–°é–‹å§‹</button>
      `;
    } else {
      message.innerHTML = `
        <h1>ğŸ˜¢ éŠæˆ²å¤±æ•—ï¼</h1>
        <p>ä½ çš„åˆ†æ•¸æ˜¯ï¼š${score}åˆ†</p>
        <button id="startBtn" aria-label="å†è©¦ä¸€æ¬¡">å†è©¦ä¸€æ¬¡</button>
      `;
    }

    document.getElementById('startBtn').addEventListener('click', startGame);
  }

  function startGame() {
    score = 0;
    timeLeft = 20;
    garbageFallSpeed = 2;
    garbageSpawnInterval = 1200;
    bucketX = gameWidth / 2 - bucket.offsetWidth / 2;
    bucket.style.left = bucketX + 'px';

    scoreboard.style.display = 'block';
    message.style.display = 'none';
    updateScoreboard();

    gameRunning = true;
    lastSpawnTime = 0;
    lastFrameTime = 0;

    clearInterval(timerId);
    startTimer();
    requestAnimationFrame(gameLoop);
  }

  window.addEventListener('keydown', (e) => {
    if (!gameRunning) return;
    if (e.key === 'ArrowLeft' || e.key === 'a' || e.key === 'A') {
      moveBucket('left');
    } else if (e.key === 'ArrowRight' || e.key === 'd' || e.key === 'D') {
      moveBucket('right');
    }
  });

  startBtn.addEventListener('click', startGame);
})();
</script>

</body>
</html>
